<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../WEB-INF/template/plantilla1.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:t="http://xmlns.jcp.org/jsf/composite/components/autentia">

    <ui:define name="content">
        <h:form id="form1" style="margin: 0 auto; width: 50%;">
            <h:panelGrid columns="1" cellspacing="30">                
                <p:tabView dynamic="true" id="tw">
                    <p:tab title="Selección Automática">
                        <h:panelGrid columns="1">
                            <h:panelGrid columns="2">
                                <p:outputLabel for="box" value="Seleccione Modalidad"/>
                                <p:selectOneMenu id="box" dynamic="true"  converter="omnifaces.SelectItemsConverter"
                                                 value="#{matriculaController.selectedPK}">
                                    <f:selectItem itemLabel="Seleccione" itemValue="#{null}"/>
                                    <f:selectItems value="#{matriculaController.grados}" var="g"
                                                   itemLabel="#{matriculaController.getGradosLabel(g.gradoPK)}"
                                                   itemValue="#{g.gradoPK}"/>
                                    <p:ajax event="itemSelect" listener="#{matriculaController.selectAño}" update="tw"/>
                                </p:selectOneMenu>
                            </h:panelGrid>
                            <p:panel header="Información de los aspirantes">
                                <h:panelGrid columns="2" cellspacing="15">
                                    <p:outputLabel value="Número de Aspirantes: "/>
                                    <p:outputLabel value="#{matriculaController.nuevasMatriculasF.size()+matriculaController.nuevasMatriculasM.size()}" />

                                    <p:outputLabel value="Aspirantes Femeninas: "/>
                                    <p:outputLabel value="#{matriculaController.nuevasMatriculasF.size()}" />

                                    <p:outputLabel value="Aspirantes Masculinos: "/>
                                    <p:outputLabel value="#{matriculaController.nuevasMatriculasM.size()}" />
                                </h:panelGrid>
                            </p:panel>
                            <p:panel header="Información de la matrícula disponible">
                                <h:panelGrid columns="2" cellspacing="15">
                                    <p:outputLabel value="Número de Secciones Disponibles: "/>
                                    <p:outputLabel value="#{matriculaController.secciones.size()}" />

                                    <p:outputLabel value="Número de Estudiantes por sección: "/>
                                    <p:outputLabel value="#{(matriculaController.nuevasMatriculasF.size()/matriculaController.secciones.size())+(matriculaController.nuevasMatriculasM.size()/matriculaController.secciones.size())}" />

                                    <p:outputLabel value="Número de aspirantes femeninas por sección: "/>
                                    <p:outputLabel value="#{matriculaController.nuevasMatriculasF.size()/matriculaController.secciones.size()}" />

                                    <p:outputLabel value="Número de aspirantes masculinos por sección: "/>
                                    <p:outputLabel value="#{matriculaController.nuevasMatriculasM.size()/matriculaController.secciones.size()}" />

                                    <p:column/>
                                    <p:commandButton id="summit" value="Proceder con la Matrícula automática" 
                                                     actionListener="#{matriculaController.guardar()}" 
                                                     update=":form1 :form0:msgs"
                                                     disabled="#{!matriculaController.btnGuardar}"/>
                                </h:panelGrid>
                            </p:panel>
                        </h:panelGrid>
                    </p:tab>
                    <p:tab title="Cambio de secciones">
                        <h:panelGrid columns="2">
                            <p:outputLabel for="aut" value="NIE del estudiante: "/>
                            <p:autoComplete id="aut" value="#{matriculaController.nie}" required="true"
                                            title="Ingrese el número de documento de identificación de la persona."
                                            completeMethod="#{matriculaController.completeText}">
                                <f:validateLength minimum="9"/>
                                <p:ajax event="itemSelect" listener="#{matriculaController.onItemSelect}" 
                                        update="form0:msgs console5 console6 secc aut nom ape"/>
                            </p:autoComplete>

                            <p:outputLabel value="Nombres"/>
                            <p:outputLabel id="nom" value="#{matriculaController.buscado.personaNombre}"/>

                            <p:outputLabel value="Apellidos"/>
                            <p:outputLabel id="ape" value="#{matriculaController.buscado.personaApellido}"/>

                            <p:outputLabel for="console5" value="Modalidad de bachillerato a la que aplica: " />
                            <p:selectOneMenu id="console5" value="#{matriculaController.mat.grado.gradoPK.gradoModalidad}"  required="true"
                                             style="width:190px" title="Seleccione la modalidad de bachillerato en la que va a iscribirse">
                                <f:selectItems value="#{matriculaController.modalidades}" />
                                <p:ajax update="console6 secc"/>
                            </p:selectOneMenu>

                            <p:outputLabel for="console6" value="Año de bachillerato al que aplica: " />
                            <p:selectOneMenu id="console6" value="#{matriculaController.mat.grado.gradoPK.idgrado}"  required="true"
                                             style="width:190px" title="Seleccione el año al que desea inscribirse"
                                             requiredMessage="Debe elegir un año de bachillerato para poder inscribirse.">
                                <f:selectItems value="#{matriculaController.niveles}"/>
                                <p:ajax update="secc"/>
                            </p:selectOneMenu>

                            <p:outputLabel for="secc" value="Sección a la que aplica: " />
                            <p:selectOneMenu id="secc" value="#{matriculaController.mat.grado.gradoPK.gradoSeccion}"  required="true"
                                             style="width:190px" title="Seleccione la sección a la que desea inscribirse"
                                             requiredMessage="Debe elegir una sección para poder inscribirse.">
                                <f:validateLength minimum="1"/>
                                <f:selectItems value="#{matriculaController.seccionesCambio}"/>
                            </p:selectOneMenu>
                            <p:column/>
                            <p:commandButton value="Guardar" style="width: 150px"/>
                        </h:panelGrid>
                    </p:tab>
                </p:tabView>
            </h:panelGrid>
        </h:form>
    </ui:define>

</ui:composition>
