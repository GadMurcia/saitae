<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (C) 2019 gabriela

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core">

    <body>
        <ui:composition template="./../WEB-INF/template/plantilla1.xhtml">
            <ui:define name="content">
                <style type="text/css">
                    .label {
                        width:20%;
                        padding:4px;
                    }

                    .value {
                        width:80%;
                        padding:4px;
                    }

                    .grid {
                        width:100%;
                    }

                    .error {
                        color: red;
                    }

                    .outputLabel {
                        font-weight: bold;
                    }

                    .grid {
                        width:33%;
                        padding:4px;
                    }
                </style>

                <f:view>

                    <p:dialog header="Asignación de Materias" widgetVar="Dmaterias" modal="true" 
                          showEffect="fade" hideEffect="fade" resizable="false">
                    <h:form id="formulario">
                        
                        <h:panelGrid columns="2">

                            <p:outputLabel value="Maestro:" for="maestro" />
                            <p:selectOneMenu id="maestro" value="#{mestromateriaController.mhm.maestro}" 
                                             required="true" requiredMessage="The Maestro field is required." 
                                             converter="omnifaces.SelectItemsConverter">
                                <f:selectItem itemValue="null" itemLabel="Seleccione" noSelectionOption="true"/>
                                <f:selectItems var="m" itemLabel="#{m.persona.personaNombre}" itemValue="#{m}" 
                                               value="#{mestromateriaController.listmaestro}"/>
                            <p:ajax event="itemSelect" listener="#{mestromateriaController.selectCampo}"/>
                            </p:selectOneMenu>
                            <p:outputLabel value="Materia:" for="materia" />
                            <p:selectOneMenu id="materia" value="#{mestromateriaController.mhm.materia}" required="true" 
                                             requiredMessage="The Materia field is required." converter="omnifaces.SelectItemsConverter">
                                 <f:selectItem itemValue="null" itemLabel="Seleccione" noSelectionOption="true"/>
                                 <f:selectItems  var="ma" itemLabel="#{ma.materiaNombre}" itemValue="#{ma}" 
                                                 value="#{mestromateriaController.listmateria}"/>
                            <p:ajax event="itemSelect" listener="#{mestromateriaController.selectCampo}"/>
                            </p:selectOneMenu>
                            <p:outputLabel value="Horario:" for="horario" />
                            <p:selectOneMenu id="horario" value="#{mestromateriaController.mhm.horario}" required="true" 
                                             requiredMessage="The Horario field is required." converter="omnifaces.SelectItemsConverter">
                                <f:selectItem itemValue="null" itemLabel="Seleccione" noSelectionOption="true"/>
                                <f:selectItems  var="h" itemLabel="#{h.horaInicio.hours}:#{h.horaInicio.minutes} - #{h.horaFin.hours}:#{h.horaFin.minutes}" 
                                                itemValue="#{h}" value="#{mestromateriaController.listhorario}" />
                            <p:ajax event="itemSelect" listener="#{mestromateriaController.selectCampo}"/>
                            </p:selectOneMenu>
                            <p:outputLabel value="Dia" for="dia" />
                            <p:selectOneMenu id="dia" value="#{mestromateriaController.diaSemanal}" required="true" 
                                             requiredMessage="The Maestro field is required.">
                                 <f:selectItem itemValue="null" itemLabel="Seleccione" noSelectionOption="true"/>
                                <f:selectItem itemLabel="Lunes" itemValue="L"/>
                                <f:selectItem itemLabel="Martes" itemValue="M"/>
                                <f:selectItem itemLabel="Miercoles" itemValue="X"/>
                                <f:selectItem itemLabel="Jueves" itemValue="J"/>
                                <f:selectItem itemLabel="Viernes" itemValue="V"/>
                                 <p:ajax event="itemSelect" listener="#{mestromateriaController.selectCampo}"/>
                            </p:selectOneMenu>

                            <p:outputLabel value="Grado:" for="grado" />
                            <p:selectOneMenu id="grado" value="#{mestromateriaController.mhm.grado}" required="true" 
                                             requiredMessage="The Grado field is required." converter="omnifaces.SelectItemsConverter">
                                 <f:selectItem itemValue="null" itemLabel="Seleccione" noSelectionOption="true"/>
                                 <f:selectItems var="g" itemLabel="#{representanteController.getLabel(g.gradoPK)}" 
                                                itemValue="#{g}" value="#{mestromateriaController.listgrado}"/>
                                <p:ajax event="itemSelect" listener="#{mestromateriaController.selectCampo}"/>
                            </p:selectOneMenu>
                            
                              
                            <p:commandButton value="Guardar" rendered="#{mestromateriaController.btnCreate}" actionListener="#{mestromateriaController.crear()}" 
                                             update=":formulario :form-mhm:tb-mhm" process="@this" onsuccess="PF('Dmaterias').hide()"/>
                                <p:commandButton value="Cancelar" actionListener="#{mestromateriaController.limpiar()}" update= ":formulario :form-mhm:tb-mhm"/>
                                <p:commandButton value="Modificar" rendered="#{mestromateriaController.btnEdit}" 
                                                 actionListener="#{mestromateriaController.crear()}" update=":formulario :form-mhm:tb-mhm" process="@this"
                                                 onsuccess="PF('Dmaterias').hide()"/>
                               
                        </h:panelGrid>
                        
                        
                    </h:form>
                    </p:dialog>


                    <h:form id="form-mhm" style="width: 80%; margin: 0 auto">
                        <h1 style="text-align: center"><h:outputText  value="Asignación de Materias y Horario"/></h1>
                        <p:dataTable value="#{mestromateriaController.obtenerTodos()}" 
                                     id="tb-mhm"
                                     var="item"
                                     lazy="true"
                                     paginator="true"
                                     rows="5"
                                     rowsPerPageTemplate="5,10,15"
                                     paginatorPosition="bottom"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     widgetVar="tablemhm"
                                     selectionMode="single" 
                                     selection="#{mestromateriaController.selectmhm}" 
                                     rowKey="#{item.mestroHorarioMateriasPK}"
                                     >
                            <p:ajax event="rowSelect" listener="#{mestromateriaController.onRowSelect}" update=":formulario"/>

                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Maestro"/>
                                </f:facet>
                                <h:outputText value="#{item.maestro.persona.personaNombre}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Materia"/>
                                </f:facet>
                                <h:outputText value="#{item.materia.materiaNombre}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Horario"/>
                                </f:facet>
                                <h:outputText value="#{item.horario.horaInicio.hours}:#{item.horario.horaInicio.minutes} - #{item.horario.horaFin.hours}:#{item.horario.horaFin.minutes}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Dia"/>
                                </f:facet>
                                <h:outputText value="#{item.mestroHorarioMateriasPK.diaSemana}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Grado"/>
                                </f:facet>
                                <h:outputText value="#{representanteController.getLabel(item.grado.gradoPK)}"/>
                            </p:column>
                        </p:dataTable>
                           <p:commandButton 
                               actionListener="#{mestromateriaController.limpiar()}"
                               value="+" styleClass="ui-priority-primary" 
                                                     update=":form0:msgs formulario"
                                                     onclick="PF('Dmaterias').show();"
                                                     title="Asignar Horarios."/>

                                    <p:contextMenu for="tb-mhm">
                                        <p:menuitem value="Modificar" update="form0:msgs formulario"
                                                    icon="fa fa-edit" onclick="PF('Dmaterias').show()"/>
                                       
                                    </p:contextMenu>
                                

                    </h:form>


                </f:view>
            </ui:define>
        </ui:composition>

    </body>
</html>